{
    "Policy": {
        "PolicyId": "urn:oasis:names:tc:acal:1.0:example:policyid:1",
        "Version": "1.0",
        "CombiningAlgId": "urn:oasis:names:tc:acal:1.0:combining-algorithm:deny-overrides",
        "PolicyDefaults": {
            "XPathPolicyDefaults": {
                "XPathVersion": "https://www.w3.org/TR/xpath20/",
                "Namespace": [
                    {
                        "Prefix": "md",
                        "Name": "urn:example:med:schemas:record"
                    }
                ]
            }
        },
        "VariableDefinition": [
            {
                "VariableId": "patient_number_matched",
                "Expression": {
                    "Apply": {
                        "FunctionId": "urn:oasis:names:tc:acal:1.0:function:string-equal",
                        "Expression": [
                            {
                                "Apply": {
                                    "FunctionId": "urn:oasis:names:tc:acal:1.0:function:string-one-and-only",
                                    "Expression": [
                                        {
                                            "AttributeDesignator": {
                                                "Category": "urn:oasis:names:tc:acal:1.0:subject-category:access-subject",
                                                "AttributeId": "urn:oasis:names:tc:acal:1.0:example:attribute:patient-number"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "Apply": {
                                    "FunctionId": "urn:oasis:names:tc:acal:1.0:function:string-one-and-only",
                                    "Expression": [
                                        {
                                            "XPathAttributeSelector": {
                                                "Category": "urn:oasis:names:tc:acal:1.0:attribute-category:resource",
                                                "Path": "md:record/md:patient/md:patient-number/text()"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                }
            }
        ],
        "CombinerInput": [
            {
                "Rule": {
                    "Id": "example_rule_1",
                    "Effect": "Permit",
                    "Description": "A person may read any medical record in the urn:example:med:schemas:record namespace for which he or she is the designated patient",
                    "Condition": {
                        "Apply": {
                            "FunctionId": "urn:oasis:names:tc:acal:1.0:function:and",
                            "Expression": [
                                {
                                    "VariableReference": {
                                        "VariableId": "patient_number_matched"
                                    }
                                },
                                {
                                    "Apply": {
                                        "FunctionId": "urn:oasis:names:tc:acal:1.0:function:string-is-in",
                                        "Expression": [
                                            {
                                                "Value": "read"
                                            },
                                            {
                                                "AttributeDesignator": {
                                                    "Category": "urn:oasis:names:tc:acal:1.0:attribute-category:action",
                                                    "AttributeId": "urn:oasis:names:tc:acal:1.0:action:action-id"
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "Apply": {
                                        "FunctionId": "urn:oasis:names:tc:acal:1.0:function:anyURI-is-in",
                                        "Expression": [
                                            {
                                                "Value": "urn:example:med:schemas:record"
                                            },
                                            {
                                                "AttributeDesignator": {
                                                    "Category": "urn:oasis:names:tc:acal:1.0:attribute-category:resource",
                                                    "AttributeId": "urn:oasis:names:tc:acal:1.0:resource:target-namespace"
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "Apply": {
                                        "FunctionId": "urn:oasis:names:tc:acal:1.0:function:any-of",
                                        "Expression": [
                                            {
                                                "Function": {
                                                    "Id": "urn:oasis:names:tc:acal:1.0:function:xpath-node-match"
                                                }
                                            },
                                            {
                                                "Value": {
                                                    "XPathCategory": "urn:oasis:names:tc:acal:1.0:attribute-category:resource",
                                                    "XPath": "md:record"
                                                }
                                            },
                                            {
                                                "AttributeDesignator": {
                                                    "Category": "urn:oasis:names:tc:acal:1.0:attribute-category:resource",
                                                    "AttributeId": "urn:oasis:names:tc:acal:1.0:content-selector"
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                }
            }
        ]
    }
}